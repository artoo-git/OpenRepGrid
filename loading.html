<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Loading and saving grids</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">OpenRepGrid</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      
      <ul class="nav navbar-nav">
        <li><a href="index.html">Home</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="news.html">News</a></li>
        <li><a href="installation.html">Installation</a></li>
        <li><a href="features.html">Features</a></li>
        <li><a href="data.html">Data</a></li>
        <li><a href="contribute.html">Contribute</a></li>
      </ul>
      
      <!-- Mailchimp signup page: http://eepurl.com/4h0t9 -->
      <ul class="nav navbar-nav navbar-right">
        <li><a href="http://eepurl.com/4h0t9" target="_blank"><span class="glyphicon glyphicon-envelope"></span> &nbsp;Newsletter</a></li>
      </ul>
    
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Loading and saving grids</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#loading-openrepgrid-files">Loading OpenRepGrid files</a><ul>
<li><a href="#microsoft-excel-files">Microsoft Excel files</a></li>
<li><a href="#txt-files">.txt files</a></li>
</ul></li>
<li><a href="#import-files-from-other-grid-programs">Import files from other grid programs</a><ul>
<li><a href="#gridcor">Gridcor</a></li>
<li><a href="#gridstat">Gridstat</a></li>
<li><a href="#gridsuite">GridSuite</a></li>
<li><a href="#scivesco">sci:vesco</a></li>
</ul></li>
<li><a href="#saving-grids">Saving grids</a><ul>
<li><a href="#txt-file">.txt file</a></li>
<li><a href="#r-data-object">R data object</a></li>
</ul></li>
</ul>
</div>

<hr>
<p>The <code>OpenRepGrid</code> R package is able to read files from different other grid programs as well as standard formats (i. e. <code>.txt</code>, <code>.xlsx</code>). All import functions follow the same naming scheme. They start with the word <code>import</code> followed by the program the file is imported from, e.g. <code>Gridstat</code>. Hence the function to import a Gridstat file is called <code>importGridstat</code>.</p>
<div id="loading-openrepgrid-files" class="section level3">
<h3>Loading OpenRepGrid files</h3>
<div id="microsoft-excel-files" class="section level4">
<h4>Microsoft Excel files</h4>
<p>You can define a grid file using Microsoft Excel. The <code>.xlsx</code> file has to be in a fixed format. See an example of a correct file below. The first row contains the minimum of the rating scale (red), the names of the elements (green) and the maximum of the rating scale (red). Below, every row contains the left construct pole (blue), the ratings (black) and the right construct pole (blue).</p>
<div class="figure">
<img src="images/excel2.png" />

</div>
<p>To load the <code>.xlsx</code> file and save it into the object <code>x</code> type the following code to the R console.</p>
<pre class="r"><code>x &lt;- importExcel(&quot;example.xlsx&quot;)</code></pre>
<p>The <code>OpenRepGrid</code> package comes with an example Excel file. If you have Excel installed, you should be able to open it by typing</p>
<pre class="r"><code>file &lt;- system.file(&quot;extdata&quot;, &quot;excel_grid_001.xlsx&quot;, package = &quot;OpenRepGrid&quot;)
system2(&quot;open&quot;, file)</code></pre>
</div>
<div id="txt-files" class="section level4">
<h4>.txt files</h4>
<p>If you do not have a grid program at hand you can define a grid using a standard text editor and by saving it as a <code>.txt</code> file. The <code>.txt</code> file has to be in a fixed format. There are three mandatory blocks each starting and ending with a predefined tag in uppercase letters. The first block starts with <code>ELEMENTS</code> and ends with <code>END ELEMENTS</code> and contains one element in each line. The other mandatory blocks contain the constructs and ratings (see below). In the block containing the constructs the left and right pole are seperated by a colon (<code>:</code>). The order of the blocks is arbitrary. All text not contained within the blocks is discarded and can thus be used for comments.</p>
<pre><code>------------ example.txt file ---------------

anything not contained within the tags will be discarded

ELEMENTS
element 1
element 2
element 3
END ELEMENTS

CONSTRUCTS
left pole 1 : right pole 1
left pole 2 : right pole 2
left pole 3 : right pole 3
left pole 4 : right pole 4
END CONSTRUCTS

RATINGS
1 3 2
4 1 1
1 4 4
3 1 1
END RATINGS

RANGE
1 4
END RANGE
---------------- end of file ----------------</code></pre>
<p>To load the <code>.txt</code> file and save it into the object <code>x</code> type the following code to the R console.</p>
<pre class="r"><code>x &lt;- importTxt(&quot;example.txt&quot;)</code></pre>
<p>You have to make sure, that the file exists in the current working directory. If not you either have to specify the whole path to the file or you must change the R working directory.</p>
<pre class="r"><code>x &lt;- importTxt(&quot;markheckmann/data/examples.txt&quot;)      # whole path to file or
getwd()                             # show current working directory
setwd(&quot;markheckmann/data&quot;)          # change working directory to the folder markheckmann/data
x &lt;- importTxt(&quot;example.txt&quot;)       # load file that is in the current working directory</code></pre>
<p>Another option that is available for all import functions is to supply no argument inside the brackets. In this case an interactive file selection dialog will open.</p>
<pre class="r"><code>x &lt;- importTxt()       # without any arguments</code></pre>
<p>This will open a dialog window which allows you to select a file manually.</p>
</div>
</div>
<div id="import-files-from-other-grid-programs" class="section level3">
<h3>Import files from other grid programs</h3>
<p>To import from other grid programs works the same as importing a <code>.txt</code> file. Either you specify the file name if it resides in the current R working directory, you supply the whole file path if it is not in the current directory or you do not supply any argumnets and and interactive file selection dialog window will open.</p>
<div id="gridcor" class="section level4">
<h4>Gridcor</h4>
<pre class="r"><code>x &lt;- importGridcor(&quot;gridcor.dat&quot;)                       # file in current R working directory or
x &lt;- importGridcor(&quot;markheckmann/data/gridcor.dat&quot;)     # whole file path or
x &lt;- importGridcor()                                    # open file selection dialog</code></pre>
</div>
<div id="gridstat" class="section level4">
<h4>Gridstat</h4>
<pre class="r"><code>x &lt;- importGridstat(&quot;gridstat.dat&quot;)                     # file in current R working directory or
x &lt;- importGridstat(&quot;markheckmann/data/gridstat.dat&quot;)   # whole file path or
x &lt;- importGridstat()                                   # open file selection dialog</code></pre>
</div>
<div id="gridsuite" class="section level4">
<h4>GridSuite</h4>
<pre class="r"><code>x &lt;- importGridsuite(&quot;gridsuite.xml&quot;)                    # file in current R working directory or
x &lt;- importGridsuite(&quot;markheckmann/data/gridsuite.xml&quot;)  # whole file path or
x &lt;- importGridsuite()                                   # open file selection dialog</code></pre>
</div>
<div id="scivesco" class="section level4">
<h4>sci:vesco</h4>
<pre class="r"><code>x &lt;- importScivesco(&quot;scivesco.scires&quot;)                   # file in current R working directory or
x &lt;- importScivesco(&quot;markheckmann/data/scivesco.scires&quot;) # whole file path or
x &lt;- importScivesco()                                    # open file selection dialog</code></pre>
</div>
</div>
<div id="saving-grids" class="section level3">
<h3>Saving grids</h3>
<p><code>OpenRepGrid</code> can currently save grids in two formats. Either as a <code>.txt</code> file or as an R data object.</p>
<div id="txt-file" class="section level4">
<h4>.txt file</h4>
<p>To save a grid as a <code>.txt</code> file use the function <code>saveAsTxt</code>. It will save the grid as a .txt file in format used by <code>OpenRepGrid</code>. This file format can also easily be edited by hand (see <code>importTxt</code> for a description). The function will open an interactive dialog box to let the user enter a filename if no file argument is supplied in the function call. Let’s suppose we want to strore the <code>boeker</code> grid.</p>
<pre class="r"><code>saveAsTxt(boeker, &quot;boeker.txt&quot;)      # save it to the file &quot;boeker.txt&quot;
saveAsTxt(boeker)                    # open a dialog box to enter the file name interactively</code></pre>
</div>
<div id="r-data-object" class="section level4">
<h4>R data object</h4>
<p>Another option is to save the grid as an <code>RData</code> object. This is done by using the function save.</p>
<pre class="r"><code>save(boeker, file=&quot;boeker.RData&quot;)     # save it to the file &quot;boeker.RData&quot;</code></pre>
<p>In future versions of OpenRepGrid will also support the <code>.xml</code> format once a community standard has been agreed upon.</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
